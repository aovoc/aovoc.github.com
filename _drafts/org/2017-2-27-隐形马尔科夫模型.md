
# Table of Contents

1.  [马尔科夫模型的基本概念](#org0a9bceb)
    1.  [隐马尔科夫模型的定义](#org62d3668)
    2.  [观测序列的生成过程](#org758e5d9)
    3.  [隐形马尔科夫模型的3个基本问题](#orgb7fbae2)
2.  [概率计算算法](#org0496eee)
    1.  [直接计算法](#orgc233457)
    2.  [前向算法](#org3ead18e)
    3.  [后向算法](#org717106c)
    4.  [一些概率与期望值的计算](#org732893f)
3.  [学习算法](#org6e5bad9)
    1.  [监督学习方法](#org8dd9a0c)
    2.  [Baum-Welch算法(EM算法)](#org2701657)
    3.  [Baum-Welch 模型参数估计公式](#org865377c)
4.  [预测算法](#orge750278)
    1.  [近似算法](#org0749145)
    2.  [维特比算法](#org62a6781)

隐形马尔科夫模型可用于标注问题的统计学习的模型，描述由隐形的马尔科夫链随机生成观测序列的过程,属于生成模型。在语音识别、自然语言处理、生物信息、模式识别等领域有广泛的应用。


<a id="org0a9bceb"></a>

# 马尔科夫模型的基本概念


<a id="org62d3668"></a>

## 隐马尔科夫模型的定义

 定义：隐马尔科夫模型是关于时序的概率模型，描述由一个隐藏的马尔科夫链随机生产不可观测的状态随机序列，再由各个状态生成一个观测而产生观测随机序列的过程。隐形的马尔科夫链随机生成的状态的序列，称为状态序列；每个状态产生一个观测，而由此产生的观测的随机序列，称为观测序列。序列的每一个位置又可以看作一个时刻。
 隐形马尔科夫模型由初始概率分布、状态转移概率分布、以及观测概率分布确定。
 形式定义：
 Q是所有可能的状态的集合，V是所有可能的观测的集合。
 <img src="ltximg/2017-2-27-隐形马尔科夫模型_8463bc759c7c2fac8534fe1c8291477cb50456b6.png" alt="2017-2-27-隐形马尔科夫模型_8463bc759c7c2fac8534fe1c8291477cb50456b6.png" />
 N：可能的状态数           M:可能的观测数
 I是长度为T的状态序列，O是对应的观测序列。
 <img src="ltximg/2017-2-27-隐形马尔科夫模型_185f55b0a68ebb75e26dc45f5ad9de439a9e448a.png" alt="2017-2-27-隐形马尔科夫模型_185f55b0a68ebb75e26dc45f5ad9de439a9e448a.png" />
 A是状态转移概率矩阵：
 <img src="ltximg/2017-2-27-隐形马尔科夫模型_3048d7fda76f96879e094a31bd673b48ed23d0e3.png" alt="2017-2-27-隐形马尔科夫模型_3048d7fda76f96879e094a31bd673b48ed23d0e3.png" />
其中，
<img src="ltximg/2017-2-27-隐形马尔科夫模型_45bebe573a62ce03964b793767716935433d77c1.png" alt="2017-2-27-隐形马尔科夫模型_45bebe573a62ce03964b793767716935433d77c1.png" /> 
是在时刻t处于状态 <img src="ltximg/2017-2-27-隐形马尔科夫模型_8d1a360a01ef9cfa6433364278b9a4a486502a8c.png" alt="2017-2-27-隐形马尔科夫模型_8d1a360a01ef9cfa6433364278b9a4a486502a8c.png" /> 在时刻t+1跳转到状态 <img src="ltximg/2017-2-27-隐形马尔科夫模型_aae3a7507303976062dd39e1bb55303f9e62b279.png" alt="2017-2-27-隐形马尔科夫模型_aae3a7507303976062dd39e1bb55303f9e62b279.png" /> 的概率。
B是观测概率矩阵：
<img src="ltximg/2017-2-27-隐形马尔科夫模型_5570231a15237cef88aa5dabdc1b5efaffbb9468.png" alt="2017-2-27-隐形马尔科夫模型_5570231a15237cef88aa5dabdc1b5efaffbb9468.png" />
其中，
<img src="ltximg/2017-2-27-隐形马尔科夫模型_7c404e736d752a107272614ca93abacf0c26153e.png" alt="2017-2-27-隐形马尔科夫模型_7c404e736d752a107272614ca93abacf0c26153e.png" />
是在时刻t处于状态 <img src="ltximg/2017-2-27-隐形马尔科夫模型_aae3a7507303976062dd39e1bb55303f9e62b279.png" alt="2017-2-27-隐形马尔科夫模型_aae3a7507303976062dd39e1bb55303f9e62b279.png" /> 的条件下生成观测 <img src="ltximg/2017-2-27-隐形马尔科夫模型_0ef7621b0f59aa9014652db2c57407215b3d66af.png" alt="2017-2-27-隐形马尔科夫模型_0ef7621b0f59aa9014652db2c57407215b3d66af.png" /> 的概率。
<img src="ltximg/2017-2-27-隐形马尔科夫模型_3a63c89be79dcc184e5bc475de58f9d32fb52f31.png" alt="2017-2-27-隐形马尔科夫模型_3a63c89be79dcc184e5bc475de58f9d32fb52f31.png" /> 是初始状态概率向量：
<img src="ltximg/2017-2-27-隐形马尔科夫模型_8a84154234f371df06c99cc2ed40e8ed98069fc1.png" alt="2017-2-27-隐形马尔科夫模型_8a84154234f371df06c99cc2ed40e8ed98069fc1.png" />
其中，
<img src="ltximg/2017-2-27-隐形马尔科夫模型_41446038165d49d7b93710b0ec0ccc7296aade0c.png" alt="2017-2-27-隐形马尔科夫模型_41446038165d49d7b93710b0ec0ccc7296aade0c.png" />
是在时刻t=1处于状态 <img src="ltximg/2017-2-27-隐形马尔科夫模型_8d1a360a01ef9cfa6433364278b9a4a486502a8c.png" alt="2017-2-27-隐形马尔科夫模型_8d1a360a01ef9cfa6433364278b9a4a486502a8c.png" /> 的慨率。

隐形马尔科夫模型由初始概率向量 <img src="ltximg/2017-2-27-隐形马尔科夫模型_3a63c89be79dcc184e5bc475de58f9d32fb52f31.png" alt="2017-2-27-隐形马尔科夫模型_3a63c89be79dcc184e5bc475de58f9d32fb52f31.png" /> 、状态转移概率矩阵A和观测概率矩阵B决定。<img src="ltximg/2017-2-27-隐形马尔科夫模型_3a63c89be79dcc184e5bc475de58f9d32fb52f31.png" alt="2017-2-27-隐形马尔科夫模型_3a63c89be79dcc184e5bc475de58f9d32fb52f31.png" /> 和A决定状态序列，B决定观测序列。因此，隐形马尔科夫模型 <img src="ltximg/2017-2-27-隐形马尔科夫模型_568ed94cb36075c6be20d509eb03cff3c86e8a60.png" alt="2017-2-27-隐形马尔科夫模型_568ed94cb36075c6be20d509eb03cff3c86e8a60.png" /> 可以用三元符号表示，即
<img src="ltximg/2017-2-27-隐形马尔科夫模型_d200d373f707f2209b79e35442208e07bf344a02.png" alt="2017-2-27-隐形马尔科夫模型_d200d373f707f2209b79e35442208e07bf344a02.png" />
<img src="ltximg/2017-2-27-隐形马尔科夫模型_9105d8035faa739534b7fbdaf37eb665361ac4d3.png" alt="2017-2-27-隐形马尔科夫模型_9105d8035faa739534b7fbdaf37eb665361ac4d3.png" /> 称为隐形马尔科夫模型的三要素。
齐次马尔可夫假设：每一时刻只依赖于前一时刻
观测独立性假设：观测只依赖于马尔科夫链的状态


<a id="org758e5d9"></a>

## 观测序列的生成过程


<a id="orgb7fbae2"></a>

## 隐形马尔科夫模型的3个基本问题

(1)概率计算问题
    给定模型 <img src="ltximg/2017-2-27-隐形马尔科夫模型_568ed94cb36075c6be20d509eb03cff3c86e8a60.png" alt="2017-2-27-隐形马尔科夫模型_568ed94cb36075c6be20d509eb03cff3c86e8a60.png" /> 和观测序列O，计算 <img src="ltximg/2017-2-27-隐形马尔科夫模型_2009f811a11697fdd4969db54d5f0ffe83bc5730.png" alt="2017-2-27-隐形马尔科夫模型_2009f811a11697fdd4969db54d5f0ffe83bc5730.png" /> 。
(2)学习问题
    已知观测序列O,估计模型 <img src="ltximg/2017-2-27-隐形马尔科夫模型_568ed94cb36075c6be20d509eb03cff3c86e8a60.png" alt="2017-2-27-隐形马尔科夫模型_568ed94cb36075c6be20d509eb03cff3c86e8a60.png" /> 参数， 使 <img src="ltximg/2017-2-27-隐形马尔科夫模型_2009f811a11697fdd4969db54d5f0ffe83bc5730.png" alt="2017-2-27-隐形马尔科夫模型_2009f811a11697fdd4969db54d5f0ffe83bc5730.png" /> 最大 <img src="ltximg/2017-2-27-隐形马尔科夫模型_5277789cde70eaf6c909158945d887691f7e86f7.png" alt="2017-2-27-隐形马尔科夫模型_5277789cde70eaf6c909158945d887691f7e86f7.png" /> 极大似然估计 。
(3)预测问题
    给定模型 <img src="ltximg/2017-2-27-隐形马尔科夫模型_568ed94cb36075c6be20d509eb03cff3c86e8a60.png" alt="2017-2-27-隐形马尔科夫模型_568ed94cb36075c6be20d509eb03cff3c86e8a60.png" /> 和 观测序列 <img src="ltximg/2017-2-27-隐形马尔科夫模型_6825b011ad1c17bc5b6bc41833a104a5a27bacfa.png" alt="2017-2-27-隐形马尔科夫模型_6825b011ad1c17bc5b6bc41833a104a5a27bacfa.png" /> , 求最有可能的对应的状态序列 <img src="ltximg/2017-2-27-隐形马尔科夫模型_2c22f477e59e4c40702072a716a680f53b0e0a50.png" alt="2017-2-27-隐形马尔科夫模型_2c22f477e59e4c40702072a716a680f53b0e0a50.png" /> 。


<a id="org0496eee"></a>

# 概率计算算法

前向算法、后向算法


<a id="orgc233457"></a>

## 直接计算法

概念上可行，计算上不可行
按概率公式直接计算，计算量大， <img src="ltximg/2017-2-27-隐形马尔科夫模型_5215ff30e691c840cafdfd70d3d7d1c64cb6ac25.png" alt="2017-2-27-隐形马尔科夫模型_5215ff30e691c840cafdfd70d3d7d1c64cb6ac25.png" /> 阶。


<a id="org3ead18e"></a>

## 前向算法

前向概率定义：给定马尔科夫模型，定义到时刻t部分观测序列为 <img src="ltximg/2017-2-27-隐形马尔科夫模型_73b362cf807efa284043e130b33a7893753e861a.png" alt="2017-2-27-隐形马尔科夫模型_73b362cf807efa284043e130b33a7893753e861a.png" /> 且状态为 <img src="ltximg/2017-2-27-隐形马尔科夫模型_8d1a360a01ef9cfa6433364278b9a4a486502a8c.png" alt="2017-2-27-隐形马尔科夫模型_8d1a360a01ef9cfa6433364278b9a4a486502a8c.png" /> 的概率为前向概率，记作
<img src="ltximg/2017-2-27-隐形马尔科夫模型_8ea9501e8d367760a0969d7962d29e291fa8918a.png" alt="2017-2-27-隐形马尔科夫模型_8ea9501e8d367760a0969d7962d29e291fa8918a.png" /> 
可以递归地求出前向概率 <img src="ltximg/2017-2-27-隐形马尔科夫模型_8f6b6cc401382ec0bbb24f23532ac484c5bdabf1.png" alt="2017-2-27-隐形马尔科夫模型_8f6b6cc401382ec0bbb24f23532ac484c5bdabf1.png" /> 及观测序列概率 <img src="ltximg/2017-2-27-隐形马尔科夫模型_2009f811a11697fdd4969db54d5f0ffe83bc5730.png" alt="2017-2-27-隐形马尔科夫模型_2009f811a11697fdd4969db54d5f0ffe83bc5730.png" /> 。

观测序列概率的前向算法
(1)初值
<img src="ltximg/2017-2-27-隐形马尔科夫模型_1e8f867680362fe91a5ed12148caed5aa9d9df16.png" alt="2017-2-27-隐形马尔科夫模型_1e8f867680362fe91a5ed12148caed5aa9d9df16.png" />
(2)递推 对 t = 1,2,&#x2026;, T -1
<img src="ltximg/2017-2-27-隐形马尔科夫模型_89ed5ca2e718a40fa355f3af5620148ecaaf3df7.png" alt="2017-2-27-隐形马尔科夫模型_89ed5ca2e718a40fa355f3af5620148ecaaf3df7.png" /> 
(3)终止
<img src="ltximg/2017-2-27-隐形马尔科夫模型_fc5ced9248ac998cb14cad30db3cbbd0a1116f56.png" alt="2017-2-27-隐形马尔科夫模型_fc5ced9248ac998cb14cad30db3cbbd0a1116f56.png" />
每一次计算直接引用前一个时刻的计算结果，避免重复计算。 计算量 <img src="ltximg/2017-2-27-隐形马尔科夫模型_9b6e2ffe20a8e2974adafe175db824ebe31ec3d1.png" alt="2017-2-27-隐形马尔科夫模型_9b6e2ffe20a8e2974adafe175db824ebe31ec3d1.png" /> 阶，直接计算是<img src="ltximg/2017-2-27-隐形马尔科夫模型_5215ff30e691c840cafdfd70d3d7d1c64cb6ac25.png" alt="2017-2-27-隐形马尔科夫模型_5215ff30e691c840cafdfd70d3d7d1c64cb6ac25.png" /> 阶。


<a id="org717106c"></a>

## 后向算法


<a id="org732893f"></a>

## 一些概率与期望值的计算


<a id="org6e5bad9"></a>

# 学习算法

根据训练数据包含观测序列和对应的状态序列还是只有观测序列，可以分别由监督学习和非监督学习实现。


<a id="org8dd9a0c"></a>

## 监督学习方法

用极大似然估计来估计隐马尔科夫模型的参数。
1.转移概率 $a<sub>ij</sub> $ 的估计
设样本中时刻t处于状态i，时刻t+1转移到状态j的频数为 <img src="ltximg/2017-2-27-隐形马尔科夫模型_0deb4ba363bdf126e4502d61196f11cf6c59c2e6.png" alt="2017-2-27-隐形马尔科夫模型_0deb4ba363bdf126e4502d61196f11cf6c59c2e6.png" /> ,那么状态转移概率 <img src="ltximg/2017-2-27-隐形马尔科夫模型_9f0d9e3f7723b661ab3e9e2e4bbbe3b933359782.png" alt="2017-2-27-隐形马尔科夫模型_9f0d9e3f7723b661ab3e9e2e4bbbe3b933359782.png" /> 的估计是
<img src="ltximg/2017-2-27-隐形马尔科夫模型_dbc7b5bb1d8408044511f336bf7b4bf258fa7c8f.png" alt="2017-2-27-隐形马尔科夫模型_dbc7b5bb1d8408044511f336bf7b4bf258fa7c8f.png" />
2.观测概率 <img src="ltximg/2017-2-27-隐形马尔科夫模型_32069b30e31b77a3ace29bca851e8ff86895a900.png" alt="2017-2-27-隐形马尔科夫模型_32069b30e31b77a3ace29bca851e8ff86895a900.png" /> 的估计
设样本中的状态为j并观测为k的频数为 <img src="ltximg/2017-2-27-隐形马尔科夫模型_cc3914705a76a72c294416f59aeb17994f273299.png" alt="2017-2-27-隐形马尔科夫模型_cc3914705a76a72c294416f59aeb17994f273299.png" /> ，那么状态为j观测为k的概率为
<img src="ltximg/2017-2-27-隐形马尔科夫模型_5afb243660b53f92c113452918c18d1fc0b267b2.png" alt="2017-2-27-隐形马尔科夫模型_5afb243660b53f92c113452918c18d1fc0b267b2.png" />
3.初始状态概率的估计 <img src="ltximg/2017-2-27-隐形马尔科夫模型_fac62c74574b636f1427c2ca62b2940a02c1958a.png" alt="2017-2-27-隐形马尔科夫模型_fac62c74574b636f1427c2ca62b2940a02c1958a.png" /> 作为S个样本中初始状态为 <img src="ltximg/2017-2-27-隐形马尔科夫模型_8d1a360a01ef9cfa6433364278b9a4a486502a8c.png" alt="2017-2-27-隐形马尔科夫模型_8d1a360a01ef9cfa6433364278b9a4a486502a8c.png" /> 的频率。


<a id="org2701657"></a>

## Baum-Welch算法(EM算法)

人工标记代价高 非监督学习方法

给定观测序列，无状态序列，目标：学习隐马尔科夫模型的参数。
EM算法学习实现：
观测数据：观测序列数据O
不可观测隐数据：状态序列数据I
对数似然函数：<img src="ltximg/2017-2-27-隐形马尔科夫模型_3d4c64285d5b32440d665d6e05b2adc3a6289cf1.png" alt="2017-2-27-隐形马尔科夫模型_3d4c64285d5b32440d665d6e05b2adc3a6289cf1.png" />

EM算法的E步：求Q函数 <img src="ltximg/2017-2-27-隐形马尔科夫模型_ff3abd06fd9823cec0db8efdc941c0ca09985000.png" alt="2017-2-27-隐形马尔科夫模型_ff3abd06fd9823cec0db8efdc941c0ca09985000.png" /> 。
EM算法的M步：极大化Q函数求 <img src="ltximg/2017-2-27-隐形马尔科夫模型_3af3c2035e0f8216d366d9b85d2155ea0b4bc0ff.png" alt="2017-2-27-隐形马尔科夫模型_3af3c2035e0f8216d366d9b85d2155ea0b4bc0ff.png" /> 。


<a id="org865377c"></a>

## Baum-Welch 模型参数估计公式


<a id="orge750278"></a>

# 预测算法


<a id="org0749145"></a>

## 近似算法

在每一时刻，选择最有可能发生的状态，作为预测结果。
优点：计算简单
缺点：不能保证预测的状态序列整体是最有可能的状态序列。


<a id="org62a6781"></a>

## 维特比算法

用动态规划解隐马尔科夫模型预测问题。
部分最优路径唯一，通过递推分割由部分最优达到全局最优。

定义在时刻t状态为i的所有单个路径 <img src="ltximg/2017-2-27-隐形马尔科夫模型_d123074378f06ca200da5d328cc4a576d48b9d5c.png" alt="2017-2-27-隐形马尔科夫模型_d123074378f06ca200da5d328cc4a576d48b9d5c.png" /> 中概率最大值为
<img src="ltximg/2017-2-27-隐形马尔科夫模型_f0a49ab6beabc8ab4ef2be457e83f0f84fbca5b4.png" alt="2017-2-27-隐形马尔科夫模型_f0a49ab6beabc8ab4ef2be457e83f0f84fbca5b4.png" />
由定义可得变量 <img src="ltximg/2017-2-27-隐形马尔科夫模型_f22fd3a6889db2cd67b760ea5e15db8e753b9230.png" alt="2017-2-27-隐形马尔科夫模型_f22fd3a6889db2cd67b760ea5e15db8e753b9230.png" /> 的递推公式：
<img src="ltximg/2017-2-27-隐形马尔科夫模型_c6c8b79c3a9a100d36151bd87a65967a71aa703a.png" alt="2017-2-27-隐形马尔科夫模型_c6c8b79c3a9a100d36151bd87a65967a71aa703a.png" />
	 <img src="ltximg/2017-2-27-隐形马尔科夫模型_145206b627d5a1c2838312d68315e45b26c07d08.png" alt="2017-2-27-隐形马尔科夫模型_145206b627d5a1c2838312d68315e45b26c07d08.png" />
定义在时刻t状态为i的所有单个路径中概率最大的路径的第t-1个结点为 <img src="ltximg/2017-2-27-隐形马尔科夫模型_32b0b929f2f69a5494fd7cd90ede50bb9ef326cf.png" alt="2017-2-27-隐形马尔科夫模型_32b0b929f2f69a5494fd7cd90ede50bb9ef326cf.png" /> :用于找出最优路径的各个结点。
<img src="ltximg/2017-2-27-隐形马尔科夫模型_9b6f48c529eda85a477acc53631a1eda4167855f.png" alt="2017-2-27-隐形马尔科夫模型_9b6f48c529eda85a477acc53631a1eda4167855f.png" />

算法
(1)初始化
(2)递推
(3)终止
(4)最优路径回溯

